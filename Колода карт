namespace DeckOfCards;
class Program
{
    static void Main(string[] args)
    {
        const string TakeCardCommand = "1";
        const string ShowPlayerCardsCommand = "2";
        const string ExitCommand = "3";

        bool isWorking = true;

        string userInput;

        Deck deck = new Deck(new List<Card>());
        Player player = new Player();


        while (isWorking)
        {
            Console.WriteLine($"Для того, чтобы взять карту нажмите - {TakeCardCommand}.\n" +
                              $"Для того, чтобы посмотреть карту нажмите - {ShowPlayerCardsCommand}.\n" +
                              $"Для выхода нажмите - {ExitCommand}");

            userInput = Console.ReadLine();
            Console.Clear();

            switch (userInput)
            {
                case TakeCardCommand:
                    player.TakeCard(deck.GiveCard());
                    break;

                case ShowPlayerCardsCommand:
                    player.ShowCards();
                    break;

                case ExitCommand:
                    isWorking = false;
                    break;

                default:
                    Console.WriteLine("Такой команды я не знаю.");
                    break;
            }
        }
    }
}

class Deck
{
    private Crupier _crupier;
    private List<Card> _card = new List<Card>();
    public Deck(List<Card> cards)
    {
        _card = cards;

        MakeCards();
    }

    public void MakeCards()
    {
        _card.Add(new Card("9", "Пика"));
        _card.Add(new Card("10", "Пика"));
        _card.Add(new Card("Валет", "Пика"));
        _card.Add(new Card("Дама", "Пика"));
        _card.Add(new Card("Король", "Пика"));
        _card.Add(new Card("Туз", "Пика"));
        _card.Add(new Card("9", "Крести"));
        _card.Add(new Card("10", "Крести"));
        _card.Add(new Card("Валет", "Крести"));
        _card.Add(new Card("Дама", "Крести"));
        _card.Add(new Card("Король", "Крести"));
        _card.Add(new Card("Туз", "Крести"));
        _card.Add(new Card("9", "Буба"));
        _card.Add(new Card("10", "Буба"));
        _card.Add(new Card("Валет", "Буба"));
        _card.Add(new Card("Дама", "Буба"));
        _card.Add(new Card("Король", "Буба"));
        _card.Add(new Card("Туз", "Буба"));
        _card.Add(new Card("9", "Черва"));
        _card.Add(new Card("10", "Черва"));
        _card.Add(new Card("Валет", "Черва"));
        _card.Add(new Card("Дама", "Черва"));
        _card.Add(new Card("Король", "Черва"));
        _card.Add(new Card("Туз", "Черва"));

        Shuffle(_card);
    }

    private void Shuffle(List<Card> cards)
    {

        Random random = new Random();
        Card tempCard;

        if (cards.Count == 0)
        {
            Console.WriteLine("Карт нет");
            return;
        }
        else
        {
            for (int i = 0; i < _card.Count; i++)
            {
                int randomIndex;

                randomIndex = random.Next(i + 1);
                tempCard = cards[i];
                cards[i] = cards[randomIndex];
                cards[randomIndex] = tempCard;
            }
        }

    }

    public Card GiveCard()
    {
        for (int i = 0; i < _card.Count; i++)
        {
            if (_card[i] != null)
            {
                Card card = _card[i];

                _card.Remove(_card[i]);

                Console.WriteLine("Вы взяли карту.");

                return card;
            }
        }

        return null;
    }
}

class Card
{
    public Card(string valueCard, string cardSuit)
    {
        CardSuit = cardSuit;
        ValueCard = valueCard;
    }

    public string CardSuit { get; private set; }
    public string ValueCard { get; private set; }

    public void ShowInfo()
    {
        Console.WriteLine($"Масть: {CardSuit}. Значение: {ValueCard}.");
    }
}

class Player
{
    private Crupier _crupier;
    private List<Card> _userCards = new List<Card>();

    public void TakeCard(Card card)
    {
        if (card != null)
        {
            _userCards.Add(card);
        }

        Console.ReadKey();
        Console.Clear();
    }

    public void ShowCards()
    {

        for (int i = 0; i < _userCards.Count; i++)
        {
            _userCards[i].ShowInfo();
        }

        if (_userCards.Count == 0)
        {
            Console.WriteLine("На руках нет карт.");
        }

        Console.ReadKey();
        Console.Clear();
    }
}

class Crupier
{
    private Stack<Card> _deckCards = new Stack<Card>();
    public bool TryGet(out Card card)
    {
        card = null;

        if (_deckCards.Count > 0)
        {
            card = _deckCards.Pop();
            Console.WriteLine("Вы взяли карту.");
        }
        else
        {
            Console.WriteLine("Карт больше нет");
        }

        return card == null;
    }
}
